# Прогнозирование продуктивности и качества молока для молочного хозяйства "Вольный луг"

## Цель проекта
Разработка двух моделей машинного обучения для оптимизации закупки скота:
1. **Прогноз годового удоя** (линейная регрессия).
2. **Оценка вероятности получения вкусного молока** (логистическая регрессия).

**Критерии отбора коров из ассоциации "ЭкоФерма":**
- Средний удой ≥ 6000 кг/год.
- Вероятность вкусного молока ≥ 0.8.

---

## Данные
Источник: ассоциация пастбищ "ЭкоФерма".  
**Признаки:**
- Порода коровы и быка-производителя.
- Тип пастбища (холмистое/равнинное).
- Возраст коровы.
- Параметры корма:
  - Энергетическая кормовая единица (ЭКЕ).
  - Сырой протеин (г).
  - Сахаро-протеиновое соотношение (СПО).
- Характеристики молока:
  - Жирность (%).
  - Содержание белка (%).

---

## Предобработка данных
- Удалены явные и скрытые дубликаты.
- Стандартизированы названия столбцов.
- Обработаны пропуски:
  - Для категориальных признаков добавлена группа "Без рейтинга".
  - Числовые пропуски заполнены медианными значениями.

---

## Исследовательский анализ данных

### Характеристики стада "Вольный луг"
| Параметр                | Значение                          |
|-------------------------|-----------------------------------|
| Доля породы "Вис Бик Айдиал" | 60%                              |
| Распределение по пастбищам  | 55% холмистые, 45% равнинные     |
| Происхождение от быков      | 70% от "Барин" и "Буйный"        |
| Возраст коров             | 90% старше 2 лет                 |
| Средний удой              | 6132.5 ± 475.9 кг/год            |

### Параметры корма и молока
| Показатель                     | Значение (Mean ± SD)      |
|--------------------------------|---------------------------|
| Энергетическая кормовая единица | 14.85 ± 1.18              |
| Сырой протеин                  | 1915.5 ± 182 г            |
| Сахаро-протеиновое соотношение | 0.93 ± 0.03               |
| Жирность молока                | 3.076 ± 0.076%            |
| Белок молока                   | 3.076 ± 0.002%            |

### Особенности стада "ЭкоФерма"
- Равное распределение по типам пастбищ.
- 70% коров старше 2 лет.
- Преобладают быки-производители "Буйный" и "Геркулес".

---

## Ключевые зависимости
- **Сильная корреляция удоя с:**
  - ЭКЕ (r = 0.82).
  - СПО (r = 0.78).
  - Жирностью молока (r = 0.75).
- **Категориальные факторы:**
  - Коровы на холмистых пастбищах дают +12% молока.
  - Порода быка "Айдиал" увеличивает удой при низком ЭКЕ.
  - Возраст >2 лет повышает продуктивность на 18%.

---

## Модели машинного обучения

### 1. Линейная регрессия (прогноз удоя)
**Целевая метрика:** MAE = 151 кг.  
**Точность:** 83.8%.  
**Влияющие признаки:**
- Порода коровы и быка.
- Тип пастбища.
- ЭКЕ, сырой протеин, СПО.  

**Прогноз для "ЭкоФерма":**
- Все 20 коров соответствуют критерию (>6000 кг/год).
- Диапазон прогноза: 6082–6964 кг.

### 2. Логистическая регрессия (вкус молока)
**Метрики:**
- Accuracy: 0.637.
- Precision: 0.8 (0 ложных срабатываний).  

**Критерию соответствуют 2 коровы:**
| ID  | Порода               | Пастбище   | Бык-производитель | Жирность | Белок | Возраст   | Удой (кг) | Вероятность вкуса |
|-----|----------------------|------------|--------------------|----------|-------|-----------|-----------|-------------------|
| 13  | Вис Бик Айдиал       | холмистое  | Соверин (Барин)    | 3.42%    | 3.075%| <2 лет    | 6082.8    | 0.87              |
| 9   | РефлешнСоверинг      | холмистое  | Айдиал (Буйный)    | 3.40%    | 3.079%| <2 лет    | 6374.1    | 0.85              |

---

## Рекомендации для "Вольный луг"
1. **Приоритетные коровы для закупки:** ID 9 и 13.
2. **Оптимизация кормления:**
   - Поддержание ЭКЕ >14.5.
   - Контроль СПО в диапазоне 0.9–1.0.
3. **Стратегия выпаса:**
   - Использовать холмистые пастбища.
   - Выбирать потомков быков "Айдиал" и "Буйный".
4. **Мониторинг молока:**
   - Целевая жирность: 3.4–3.6%.
   - Белок: ≥3.075%.

